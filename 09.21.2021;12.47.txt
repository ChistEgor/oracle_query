SELECT 
    UPPER(p_created.FIRST_NAME)||' '||UPPER(p_created.LAST_NAME) CREATED_BY
    , PR.DATE_CREATED CREATED_DATE
    , UPPER(p_modified.FIRST_NAME)||' '||UPPER(p_modified.LAST_NAME) MODIFIED_BY
    , (CASE  PR_SEVERITY_TYPE.NAME
    WHEN 'High' THEN 'URGENT'
    WHEN 'Medium' THEN 'MEDIUM'
    WHEN 'Minor' THEN 'LOW'
    ELSE NULL END) as PRIORITY
    , TW_V_DEPARTMENT_RESPONSIBLE.S_VALUE as DEPARTMENT_NAME
    , TW_V_ROOT_CAUSE_LOCATION.S_VALUE as PLANT_AREA_NAME
    , PR.DATE_UPDATED MODIFIED_DATE
    , TW_V_PRODUCT_FAMILY.S_VALUE PRODUCTLINE_NAME 
    , DIVISION_TYPE.NAME INITIATING_SITE_CODE
    , CASE WHEN PR.PARENT_ID IS NULL THEN 'General' ELSE 'Complaint' end CAPA_SOURCE
    , DIVISION_TYPE.NAME INITIATING_SITE_NAME
    , PR.ID CAPA_SOURCE_NUMBER
    --CLOSURE_COMMENT
    , TW_V_DESCRIPTION.TEXT PROBLEM_STATEMENT
    , CASE WHEN PR.PARENT_ID is not null THEN 'Yes' END IS_CAPA_CREATED_FROM_NC
    --EFFECT_REVIEW_INTERVAL
    --CAPA_AGE    
    , PR.DATE_OPENED INITIATION_DATE
    , PR.NAME TITLE
    , PR.ID RECORD_NUMBER
    , CASE WHEN PR_STATUS_TYPE.IS_CLOSED = 1 THEN 'CLOSED' else 'INWORKS' END STATUS
    , UPPER(p_coord.FIRST_NAME)||' '||UPPER(p_coord.LAST_NAME) COORDINATOR_CODE
    , PR.RESPONSIBLE_NAME COORDINATOR_NAME
    , PR.DATE_CLOSED CLOSED_DATE
    --, PR.STATUS_TYPE PHASE
    --PRIMARY_STATUS 
    --EFFECT_REVIEW_INTVL_UNIT
    --PRODUCT_CODE 
    --PROCESS_CODE
    , DIVISION_TYPE.NAME OWNING_SITE_CODE
    , UPPER(p_init.FIRST_NAME)||' '||UPPER(p_init.LAST_NAME) INITIATED_BY_CODE
    , UPPER(p_coord.FIRST_NAME)||' '||UPPER(p_coord.LAST_NAME) CAPA_OWNER_CODE
    , TW_V_PRODUCT.S_VALUE PRODUCT_NAME
    , DIVISION_TYPE.NAME OWNING_SITE_NAME
    , p_init.FIRST_NAME||' '||p_init.LAST_NAME INITIATED_BY_NAME
    , PR.RESPONSIBLE_NAME CAPA_OWNER_NAME
    --ACTION_PLAN_VERIFIED    
FROM SYSADM2.PR PR
    INNER JOIN SYSADM2.PROJECT PROJECT 
    ON PR.PROJECT_ID=PROJECT.ID
    LEFT OUTER JOIN SYSADM2.TW_V_ROOT_CAUSE_LOCATION TW_V_ROOT_CAUSE_LOCATION 
    ON PR.ID=TW_V_ROOT_CAUSE_LOCATION.PR_ID     
    LEFT OUTER JOIN SYSADM2.TW_V_DESCRIPTION TW_V_DESCRIPTION 
    ON PR.ID=TW_V_DESCRIPTION.PR_ID 
    LEFT OUTER JOIN SYSADM2.PR_SEVERITY_TYPE PR_SEVERITY_TYPE
    ON PR.SEVERITY_TYPE=PR_SEVERITY_TYPE.ID
    INNER JOIN SYSADM2.DIVISION_TYPE DIVISION_TYPE
    ON PROJECT.DIVISION_TYPE=DIVISION_TYPE.ID
    --
    
    LEFT JOIN TW_V_PRODUCT TW_V_PRODUCT
    ON PR.ID = TW_V_PRODUCT.PR_ID
    LEFT JOIN TW_V_PRODUCT_FAMILY TW_V_PRODUCT_FAMILY
    ON PR.ID = TW_V_PRODUCT_FAMILY.PR_ID
        
    --
    LEFT JOIN TW_V_DEPARTMENT_RESPONSIBLE TW_V_DEPARTMENT_RESPONSIBLE
    ON PR.ID = TW_V_DEPARTMENT_RESPONSIBLE.PR_ID
    join sysadm2.person p_created
    on PR.CREATED_BY_REL_ID = p_created.id
    join sysadm2.person p_modified
    on PR.UPDATED_BY_REL_ID = p_modified.id
    join PR_STATUS_TYPE
    on PR_STATUS_TYPE.ID = PR.status_type    
    join sysadm2.person p_coord
    on PR.RESPONSIBLE_REL_ID = p_coord.id
    join sysadm2.person p_init
    on PR.RESPONSIBLE_REL_ID = p_init.id
WHERE  PROJECT.NAME='CAPA' AND (PR.ID>=283811 AND PR.ID<=283814)